<html lang="en">
	<head>
		<style id="style"></style>
		<style id="style2"></style> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>
		<h1>Clicker Game</h1>
		<p>Welcome to this simple clicker game! This is where you click the button to... uhh... earn <a id="amount">a</a> <a id="currency">click</a><a id="sornos"></a>. <a id="note2">(Yeah... it's very awkward to read it out loud, so I'm planning to change that later.)</a></p>
		<button id="button">Click me</button> <button id="button2" style="display: none">Click me</button>
		<br>
		<a id="clicks"></a>
		<p id="note">As you can see, there's not a whole lot going on. I'll keep working on this as you and other users make progress! Take care.</p>
		<div id="upgrades"></div>
		<script>
//(async function() {
	const AOCText = document.getElementById("amount"), AOCS = document.getElementById("sornos"), button = document.getElementById("button"), button2 = document.getElementById("button2"), currency = document.getElementById("currency"), numOfClicks = document.getElementById("clicks"), upgrades = document.getElementById("upgrades"), note = document.getElementById("note"), note2 = document.getElementById("note2"), style = document.getElementById("style"), style2 = document.getElementById("style2");
	let clicks = 0, cl = 1;
	const thingsToTrigger = [function() {}];
	let state = 0;
	let bitwiseIntegers = [0b01111011, 0, 0, 0];
	const numberWords = ["zero", "a", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "seventeen", "eighteen", "nineteen", "twenty"];
	const upgradesElements = [];
	let alertFor = {notEnoughPresses: true};
	let purchaseSFX, notEnoughSFX, mouseSFX = [];
	function n() {return document.body.appendChild(document.createElement("br"))}
	let muteSFX = null, muted = false;
	async function alertBox(textD) {
		if (alertFor.polishedAlert) {
			const box = document.createElement("div");
			box.style = "position: absolute; left: calc(50vw - 200px); top: calc(50vh - 100px); width: 400px; height: 200px; border: 2px black solid; box-sizing: border-box; background-color: white;";
			const text = document.createElement("a");
			text.style = "white-space: pre-wrap; word-wrap: break-word;";
			text.textContent = textD;
			document.body.appendChild(box);
			box.appendChild(text);
			box.appendChild(document.createElement("br"));
			const OK = document.createElement("button");
			OK.textContent = "OK";
			OK.style = "position: absolute; bottom: 0; left: 0; right: 0; padding: 2px"; // Position OK button to the bottom-left area
			box.appendChild(OK);
			return new Promise(function(resolve, reject) {
				setTimeout(function() {
					function e(event) {if (!event || !event.target || !box.contains(event.target)) {document.body.removeEventListener("click", e);box.remove();resolve();}}
					OK.onclick = function(event) {event.stopPropagation();e();}
					document.body.addEventListener("click", e);
				}, 100);
			});
		} else alert(textD);
	}
	function au(file) {
		const audio = document.createElement("audio");
		const source1 = document.createElement("source");
		source1.type = "audio/" + file.split(".")[1];
		source1.src = "./" + file;
		document.body.appendChild(audio);
		audio.appendChild(source1);
		return audio;
	}
	function setupUpgrade(obj) {
		obj.element.onclick = async function() {
			if (clicks >= obj.cost) {clicks -= obj.cost; obj.buy(obj); updateClicksText(); if(purchaseSFX) {
				purchaseSFX.pause();
				purchaseSFX.currentTime = 0;
				purchaseSFX.play();
			}} else {
				if (alertFor.notEnoughPresses) {
					if (notEnoughSFX) {
						notEnoughSFX.pause();
						notEnoughSFX.currentTime = 0;
						notEnoughSFX.play();
					}
					await alertBox("You do not have enough presses to afford this upgrade. You need " + Math.abs(obj.cost - Math.round(clicks)).toFixed(0) + " more to do that.");
				}
				if ((bitwiseIntegers[0] & 0b00000010) && !(bitwiseIntegers[0] & 0b00000100)) {
					bitwiseIntegers[0] |= 0b00000100;
					addUpgradeButton({cost: 6, buy: function(obj) {
						if (bitwiseIntegers[0] & 0b00000010) bitwiseIntegers[0] ^= 0b00000010;
						alertFor.notEnoughPresses = false;
						n();
						const text = document.createElement("a");
						text.textContent = "Alert when presses are not enough: ";
						document.body.appendChild(text);
						const check = document.createElement("input");
						check.type = "checkbox";
						check.oninput = function() {alertFor.notEnoughPresses = check.checked}
						document.body.appendChild(check);
						obj.unregister();
					}}, "Add not-enough alert setting (costs 6 presses)");
					addUpgradeButton({cost: 30, buy: function(obj) {
						if (bitwiseIntegers[0] & 0b00000010) bitwiseIntegers[0] ^= 0b00000010;
						alertFor.polishedAlert = true;
						obj.unregister();
					}}, "Polish alert message box (costs 30 presses)");
					addUpgradeButton({cost: 250, buy: function(obj) {
						if (bitwiseIntegers[0] & 0b00000010) bitwiseIntegers[0] ^= 0b00000010;
						purchaseSFX = document.createElement("audio");
						const source1 = document.createElement("source");
						const source2 = document.createElement("source");
						source1.type = "audio/ogg";
						source1.src = "./chaching.ogg";
						source2.type = "audio/mp3";
						source2.src = "./chaching.mp3";
						document.body.appendChild(purchaseSFX);
						purchaseSFX.appendChild(source1);
						purchaseSFX.appendChild(source2);
						addUpgradeButton({cost: 300, buy: function(obj) {
							mouseSFX.push([au("mousedown0.wav"), au("mouseup0.wav")]);
							mouseSFX.push([au("mousedown1.wav"), au("mouseup1.wav")]);
							mouseSFX.push([au("mousedown2.wav"), au("mouseup2.wav")]);
							document.body.addEventListener("mousedown", function() {
								if (!muted) mouseSFX[Math.floor(Math.random() * mouseSFX.length)][0].play();
							});
							document.body.addEventListener("mouseup", function() {
								if (!muted) mouseSFX[Math.floor(Math.random() * mouseSFX.length)][1].play();
							});
							obj.unregister();
						}}, "Mouse click SFX (costs 300 presses)");
						addUpgradeButton({cost: 150, buy: function(obj) {
							muteSFX = document.createElement("button");
							muteSFX.style = "position: absolute; left: 60vw;";
							muteSFX.textContent = "Mute";
							muteSFX.onclick = function() {
								muted = !muted;
								muteSFX.textContent = muted ? "Unmute" : "Mute";
							}
							document.body.appendChild(muteSFX);
							obj.element.textContent = "Polish mute button (costs 100 presses)";
							obj.cost = 100;
							obj.buy = function(obj) {
								muteSFX.textContent = "";
								const image = document.createElement("img");
								image.src = "./" + (muted ? "muted.png" : "unmuted.png");
								muteSFX.onclick = function() {
									muted = !muted;
									image.src = "./" + (muted ? "muted.png" : "unmuted.png");
								}
								muteSFX.appendChild(image);
								muteSFX.style = "position: absolute; left: calc(100vw - 32px); top: 0px; width: 32px; height: 32px;";
								image.style = "width: 32px; height: 32px; margin-left: -8px; margin-top: -3px";
								obj.unregister();
							}
						}}, "Mute SFX button (costs 150 presses)");
						addUpgradeButton({cost: 200, buy: function(obj) {
							notEnoughSFX = document.createElement("audio");
							const source1 = document.createElement("source");
							const source2 = document.createElement("source");
							source1.type = "audio/ogg";
							source1.src = "./notEnough.ogg";
							source2.type = "audio/mp3";
							source2.src = "./notEnough.mp3";
							document.body.appendChild(notEnoughSFX);
							notEnoughSFX.appendChild(source1);
							notEnoughSFX.appendChild(source2);
							obj.unregister();
						}}, "Not enough SFX (costs 200 presses)");
						obj.unregister();
					}}, "Cha-ching SFX per purchase (costs 250 presses)");
				}
			}
		}
		return obj;
	}
	function updateClicksText() {
		numOfClicks.textContent = (bitwiseIntegers[0] & 0b00000001 ? "Number of clicks: " : "Number of presses: ") + Math.round(clicks).toFixed(0);
	}
	function addUpgradeButton(obj, text) {
		let line = null;
		if (upgradesElements.length) line = upgrades.appendChild(document.createElement("br"));
		const upgradeButton = document.createElement("button");
		upgrades.appendChild(upgradeButton);
		upgradeButton.textContent = text;
		obj.element = upgradeButton;
		obj.unregister = function() {
			upgradeButton.remove();
			if (line) line.remove();
		}
		upgradesElements.push(setupUpgrade(obj));
	}
	let autoclickers = [];
	let narrowDown = 0;
	function spawnAutoclicker(ms) {
		if (!narrowDown) narrowDown = ms; else narrowDown = narrowDown * (ms/1750);
		const image1 = document.createElement("img");
		const image2 = document.createElement("img");
		image1.src = "./mouse1.png";
		image2.src = "./mouse2.png";
		const bounds = button2.getBoundingClientRect();
		const same = "position: absolute; left: " + Math.floor(bounds.x + Math.random() * bounds.width - 3) + "px; top: " + Math.floor(bounds.y + Math.random() * bounds.height - 3) + "px; width: 20px; height: 20px;";
		image1.style = same;
		image2.style = same;
		document.body.appendChild(image1);
		document.body.appendChild(image2);
		image2.style.display = "none";
		const dd = Math.min(50, ms - 100);
		const id1 = setInterval(function() {
			button.click();
			if (mouseSFX.length) {
				image1.style.display = "none";
				image2.style.display = "";
			}
		}, ms);
		let id2 = [];
		setTimeout(function() {
			id2.push(setInterval(function() {
				image2.style.display = "none";
				image1.style.display = "";
			}, ms));
		}, dd);
		image1.onclick = () => button.click();
		image2.onclick = () => button.click();
		autoclickers.push([id1, id2, image1, image2]);
	}
	let notBoughtAuto = true;
	function updateState() {
		switch (state) {
			case 0: {
				if (clicks > 5 && bitwiseIntegers[0] & 0b00000001) {
					bitwiseIntegers[0] ^= 0b00000001;
					addUpgradeButton({cost: 10, buy: function(obj) {
						if (cl === 1) obj.cost = 2;
						obj.cost = obj.cost + 3 + Math.floor(obj.cost / 10);
						obj.element.textContent = "+1 press per click (costs " + obj.cost + " presses)";
						cl++;
						AOCText.textContent = numberWords[cl] || cl;
						AOCS.textContent = "es";
					}}, "+1 press per click (costs 10 presses)");
					addUpgradeButton({cost: 20, buy: function(obj) {
						obj.cost = obj.cost + 5 + Math.floor(obj.cost / 10);
						obj.element.textContent = "+1 autoclicker (costs " + obj.cost + " presses)";
						button2.style="";
						spawnAutoclicker(1000);
						if (notBoughtAuto) {
							n();
							const antilag = document.createElement("button");
							antilag.textContent = "If this game lags, press this";
							document.body.appendChild(antilag);
							antilag.onclick = function() {
								for (const au of autoclickers) {
									clearInterval(au[0]);
									clearInterval(au[1][0]);
									au[2].src="";
									au[2].remove();
									au[3].src="";
									au[3].remove();
								}
								setInterval(() => button.click(), narrowDown);
								narrowDown = 0;
								autoclickers = [];
							}
						}
						notBoughtAuto = false;
					}}, "+1 autoclicker (costs 20 presses)");
					currency.textContent = "press";
					note2.textContent = "That's less awkward than before.";
					note.textContent = "But... upgrades? Wait, I don't recall adding that as an in-game feature. My game better not be sentient or... self-modifying.";
				}
				if (clicks > 20 && bitwiseIntegers[0] & 0b00100000) {
					bitwiseIntegers[0] ^= 0b00100000;
					addUpgradeButton({cost: 40, buy: function(obj) {
						note.textContent = "Now my clicker game has an icon, and a title! Goodbye, ugly old \"unnamedbruh\" title! Hello, \"Clicker Game\"!";
						const icon = document.createElement("link");
						const title = document.createElement("title");
						title.textContent = "Clicker Game";
						document.head.appendChild(title);
						icon.rel = "icon";
						icon.type = "image/x-icon";
						icon.href = "./favicon.ico";
						document.head.appendChild(icon);
						obj.unregister();
					}}, "Add design for this open tab (costs 40 presses)");
				}
				if (clicks > 60 && bitwiseIntegers[0] & 0b00001000) {
					bitwiseIntegers[0] ^= 0b00001000;
					addUpgradeButton({cost: 100, buy: function(obj) {
						style.textContent = `p, a, span, h1 {padding-left: 50px;text-indent: -50px;}`;
						AOCText.style = "padding-left: 0px; text-indent: 0px;";
						AOCS.style = "padding-left: 0px; text-indent: 0px;";
						currency.style = "padding-left: 0px; text-indent: 0px;";
						note2.style = "padding-left: 0px; text-indent: 0px;";
						note.textContent = "Hey, this isn't so bad! Now my page looks a little professional, but it still needs more tweaks.";
						obj.unregister();
					}}, "Indent text (costs 100 presses)");
				}
				if (clicks > 100 && bitwiseIntegers[0] & 0b00010000) {
					bitwiseIntegers[0] ^= 0b00010000;
					addUpgradeButton({cost: 150, buy: function(obj) {
						note.textContent = "Dark mode?! This will definitely be important for a clicker game \"night owls\" might access.";
						n();
						const text = document.createElement("a");
						text.textContent = "Dark mode: ";
						document.body.appendChild(text);
						const check = document.createElement("input");
						check.type = "checkbox";
						check.oninput = function() {
							if (check.checked) {
								document.body.style.color = "#999999";
								document.body.style.backgroundColor = "black";
								document.body.style.colorScheme = "dark";
							} else {
								document.body.style.color = "";
								document.body.style.backgroundColor = "";
								document.body.style.colorScheme = "";
							}
						}
						document.body.appendChild(check);
						obj.unregister();
					}}, "Add dark mode (costs 150 presses)");
				}
				if (clicks > 150 && bitwiseIntegers[0] & 0b01000000) {
					bitwiseIntegers[0] ^= 0b01000000;
					addUpgradeButton({cost: 300, buy: function(obj) {
						note.textContent = "Okay, this game is going to look super polished in no-time!";
						style2.textContent = "button {background-image: linear-gradient(#CCCCCC, #AAAAAA); border-radius: 8px; cursor: pointer;}\nbutton:hover {background-image: linear-gradient(#DDDDDD, #BBBBBB);}\nbutton:active {background-image: linear-gradient(#AAAAAA, #888888);}";
						obj.element.textContent = "Switch font to Arial (costs 250 presses)";
						obj.cost = 250;
						obj.buy = function(obj) {
							document.body.style.fontFamily = "Arial Light, sans-serif";
							obj.unregister();
						}
					}}, "Polish buttons (costs 300 presses)");
				}
			}
		}
	}
	button.onclick = function() {
		clicks += cl;
		updateClicksText();
		updateState();
	}
//})();
		</script>
	</body>
</html>
